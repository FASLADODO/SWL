%addpath('../../src/geometry');

%-----------------------------------------------------------

image_width = 4384;
image_height = 6576;

num_pts = 6;
pts = cell(num_pts, 1);

% angle, x, y, confidence.
pts{1} = [
	0,2506,3603,1
	15,2464,3604,1
	30,2401,3607,1
	45,2325,3608,1
	60,2237,3612,1
	75,2146,3613,1
	90,2058,3611,1
	105,1981,3609,1
	120,1918,3607,1
	135,1879,3606,1
	150,1860,3604,1
	165,1865,3604,1
	180,1892,3602,1
	195,1938,3598,1
	210,2000,3598,1
	225,2073,3594,1
	240,2154,3591,1
	255,2238,3589,1
	270,2321,3590,1
	285,2394,3590,1
	300,2455,3590,1
	315,2502,3594,1
	330,2529,3597,1
	345,2533,3600,1
];
pts{2} = [
	0,2604,3688,1
	15,2592,3690,1
	30,2552,3697,1
	45,2489,3700,1
	60,2403,3701,1
	75,2299,3707,1
	90,2188,3706,1
	105,2077,3709,1
	120,1977,3721,1
	135,1893,3712,1
	150,1833,3707,1
	165,1795,3698,1
	180,1791,3696,1
	195,1807,3685,1
	210,1853,3681,1
	225,1922,3678,1
	240,2007,3674,1
	255,2104,3674,1
	270,2205,3673,1
	285,2308,3673,1
	300,2401,3672,1
	315,2480,3672,0.25
	330,2546,3684,1
	345,2587,3689,1
];
pts{3} = [
	0,3033,3738,1
	15,3064,3744,1
	30,3033,3750,1
	45,2943,3766,1
	60,2796,3774,1
	75,2597,3781,1
	90,2370,3783,1
	105,2125,3792,1
	120,1879,3786,1
	135,1673,3784,1
	150,1507,3779,1
	165,1395,3774,1
	180,1337,3762,1
	195,1351,3757,1
	210,1417,3753,1
	225,1530,3746,1
	240,1689,3739,1
	255,1866,3736,1
	270,2070,3736,1
	285,2276,3736,1
	300,2483,3741,1
	315,2664,3741,1
	330,2819,3750,1
	345,2953,3765,1
];
pts{4} = [
	0,1307,3960,1
	15,1407,3943,1
	30,1554,3930,1
	45,1737,3920,1
	60,1944,3913,1
	75,2161,3913,1
	90,2384,3912,0.5
	105,2597,3917,1
	120,2788,3924,1
	135,2949,3936,1
	150,3064,3952,1
	165,3127,3972,1
	180,3132,3993,1
	195,3068,4013,1
	210,2936,4036,1
	225,2740,4056,1
	240,2503,4070,1
	255,2233,4076,0.25
	270,1955,4082,1
	285,1712,4078,1
	300,1508,4070,1
	315,1352,4054,1
	330,1266,4037,1
	345,1247,4019,1
];
pts{5} = [
	0,2706,4112,1
	15,2586,4125,1
	30,2439,4133,1
	45,2267,4137,1
	60,2093,4138,1
	75,1927,4132,1
	90,1782,4124,1
	105,1672,4115,1
	120,1598,4102,1
	135,1573,4090,1
	150,1585,4075,1
	165,1639,4062,1
	180,1792,4052,1
	195,1846,4042,1
	210,1982,4037,1
	225,2136,4030,1
	240,2287,4031,1
	255,2436,4033,1
	270,2569,4040,1
	285,2682,4048,1
	300,2764,4058,1
	315,2813,4073,1
	330,2821,4087,1
	345,2784,4101,1
];
pts{6} = [
	0,2617,4469,1
	15,2658,4482,1
	30,2671,4498,1
	45,2651,4514,1
	60,2602,4530,1
	75,2520,4542,1
	90,2416,4554,1
	105,2292,4559,1
	120,2161,4561,0.75
	135,2031,4556,1
	150,1918,4549,1
	165,1827,4537,1
	180,1762,4522,1
	195,1729,4507,1
	210,1730,4490,1
	225,1761,4475,1
	240,1820,4462,1
	255,1902,4452,1
	270,2005,4443,1
	285,2117,4438,1
	300,2234,4437,0.5
	315,2348,4440,1
	330,2458,4448,1
	345,2548,4454,1
];

for kk = 1:num_pts
	pts{kk}(:,1) = pts{kk}(:,1) * pi / 180;
	pts{kk}(:,2) = pts{kk}(:,2) / image_width;
	pts{kk}(:,3) = 1 - pts{kk}(:,3) / image_height;
end;

%----------

ABCDEF = zeros(num_pts, 6);
for kk = 1:num_pts
	ABCDEF(kk,:) = fit_conic(pts{kk}(:,2), pts{kk}(:,3));
end;

%----------

pt_colors = { 'r.', 'g.', 'b.', 'c.', 'm.', 'y.' };
line_colors = { 'r-', 'g-', 'b-', 'c-', 'm-', 'y-' };

figure;
hold on;
for kk = 1:num_pts
	plot(pts{kk}(:,2), pts{kk}(:,3), pt_colors{kk}, 'MarkerSize', 5);
	draw_conic(ABCDEF(kk,:), line_colors{rem(kk + 2, size(line_colors, 2)) + 1})
end;
hold off;
